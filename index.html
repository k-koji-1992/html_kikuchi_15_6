<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/BmapQuery.js"></script>
    <title>EATEDRIVE</title>
</head>

<body>
    <div>
    <div>
        <header class="header">
            <div class="logo">

            </div>
            <nav>
                <ul>
                    <li><a href="#about" class="about">このサイトについて</a></li>
                    <li><a href="#course" class="map">マップ</a></li>
                    <li><a href="#news" class="news">お知らせ</a></li>
                    <li><a href="#register" class="register">会員登録</a></li>
                    <li><a href="#contact" class="contact">お問い合わせ</a></li>
                </ul>
            </nav>
        </header>
    </div>
<div>

 <!-- MAP[START] -->
 <div id="myMap" style="width: 50%; height: 700px;"></div>
 <!-- MAP[END] -->
</div>
   

    <!-- Directions[START] -->
    <div id="searchBoxContainer">
        出発地:<input type="text" id="from" value="">
        目的地:<input type="text" id="to" value="">

        <select id="mode">
            <option value="walking">walking</option>
            <option value="driving">driving</option>
            <option value="transit">transit</option>
        </select>
        <input type="button" id="search" value="ルート検索">
   
        <div id="direction"></div>
    <!-- Directions[END] -->

    <!-- Recruit API Results[START] -->
    <div id="recruitResults">
        <!-- ここにリクルートAPIからの結果を表示するコンテナを作成します -->
    </div>
    <!-- Recruit API Results[END] -->
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=[]'
        async defer></script>
    <script src="http://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key=[]"></script>

    <script>
        // 1．位置情報の取得に成功した時の処理
        function mapsInit(position) {
            //lat=緯度、lon=経度 を取得
            console.log(position);
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            console.log(lat, lon);
        };
        //2． 位置情報の取得に失敗した場合の処理
        function mapsError(error) {
            let e = "";
            if (error.code == 1) { //1＝位置情報取得が許可されてない（ブラウザの設定）
                e = "位置情報が許可されてません";
            }
            if (error.code == 2) { //2＝現在地を特定できない
                e = "現在位置を特定できません";
            }
            if (error.code == 3) { //3＝位置情報を取得する前にタイムアウトになった場合
                e = "位置情報を取得する前にタイムアウトになりました";
            }
            alert("エラー：" + e);
        };

        //3.位置情報取得オプション
        var set = {
            enableHighAccuracy: true, //より高精度な位置を求める
            maximumAge: 20000,        //最後の現在地情報取得が20秒以内であればその情報を再利用する設定
            timeout: 10000            //10秒以内に現在地情報を取得できなければ、処理を終了
        };

        //Main:位置情報を取得する処理 //getCurrentPosition :or: watchPosition
        navigator.geolocation.getCurrentPosition(mapsInit, mapsError, set);

        //Initialization processing
        let map;
      
        function GetMap() {
            
            //1. Init
            const map = new Bmap("#myMap");
           
            //2. geolocation: Display Map
            //------------------------------------------------------------------------
            map.geolocation(function (data) {
                //location
                const lat = data.coords.latitude;
                const lon = data.coords.longitude;
                //Map
                map.startMap(lat, lon, "load", 10);
                //pin
                map.pin(lat, lon, "#ff0000");
                map.infobox(lat, lon, "Title", "Description");
            });
            

            document.getElementById("search").onclick = function () {
                //Get From,To
                const from = document.getElementById("from").value;  //StartPoint
                const to = document.getElementById("to").value;    //EndPoint
                const mode = document.getElementById("mode").value;  //RouteMode[walking,driving]
                const array = document.getElementById("array").value;   //Waypoints...
                map.direction("#direction", mode, from, to, array);  //Direction Methed

                //経由地なし
                // map.direction("#direction",mode,from,to);

            };

            map.selectedSuggestion("#from","#searchBoxContainer");
            map.selectedSuggestion("#to","#searchBoxContainer");

        }



    </script>



</body>

</html>